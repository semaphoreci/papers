version: v1.0
name: Publish to WordPress
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: SFTP Upload
    task:
      secrets:
        - name: wordpress-sftp
      jobs:
        - name: Upload files
          commands:
            - cache restore build-pdf-$SEMAPHORE_WORKFLOW_ID
            - cd build/pdf
            - 'for f in *.pdf; do curl -k curl -k -u $FTP_USER:$FTP_PASSWORD sftp://$FTP_HOST:$FTP_PORT/wp-content/uploads/pdf-downloads/ -T "$f"; done'
